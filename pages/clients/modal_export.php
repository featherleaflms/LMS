<div class="modal fade" id="modalExport" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document" style="width: 100%;max-width: 2000px;margin: 0.5rem;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><span class='ion-compose'></span> Export Client Template</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">Ã—</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <h3 class="text-info">Template Overview</h3>
                    <div style='width:100%' class='w3-animate-left'>
                        <table id="tbl_export_template">
                            <tr>
                                <th>*Branch (BCD,LC)</th>
                                <th>*First Name</th>
                                <th>Middle Name</th>
                                <th>*Last Name</th>
                                <th>Suffix</th>
                                <th>*Civil Status(Single,Married,Widowed,Seperated)</th>
                                <th>*Birth Date(mm/dd/YYYY)</th>
                                <th>*Contact Number</th>
                                <th>*Address</th>
                                <th>*Address Status (Owned,Rented,Free Use)</th>
                                <th>*Certificate #</th>
                                <th>*Issued at</th>
                                <th>*Certificate Date</th>
                                <th>*Employer</th>
                                <th>*Employer Address</th>
                                <th>*Employer Contact #</th>
                                <th>*Position</th>
                                <th>*Income</th>
                                <th>*Employment Status</th>
                                <th>*Length</th>
                                <th>Previous Employment</th>
                                <th>Spouse</th>
                                <th>Residence</th>
                                <th>Certificate #</th>
                                <th>Issued At</th>
                                <th>Certificate Date(mm/dd/YYYY)</th>
                                <th>Spouse Employer</th>
                                <th>Business Address</th>
                                <th>Telephone #</th>
                                <th>Position</th>
                                <th>Income</th>
                                <th>Length of Employment</th>
                                <th>Prev Employment</th>
                                <th>Status</th>
                                <th>No. of Child</th>
                                <th>Dependent</th>
                                <th>College</th>
                                <th>High School</th>
                                <th>Elementary</th>
                                <th>*Source of Income</th>
                                <th>*Source of income by whom</th>
                                <th>*Monthly Income</th>
                                <th>*Reference Name 1</th>
                                <th>*Reference Address 1</th>
                                <th>*Reference Name 2</th>
                                <th>Reference Address 2</th>
                                <th>*Reference Name 3</th>
                                <th>*Reference Address 3</th>
                                <th>*Aprox Total Income</th>
                                <th>*Total Outstanding Obligation</th>
                                <th>*Business Name</th>
                                <th>*Address</th>
                                <th>*Telephone No.</th>
                                <th>*Position</th>
                                <th>*Kind</th>
                                <th>*Length</th>
                                <th>*Capital Invested</th>
                                <th>*Business Type (Sole,Owner,Partner)</th>
                                <th>*Insurance</th>
                                <th>*Amount</th>
                                <th>*Maturity</th>
                                <th>*Bank Transaction</th>
                                <th>*Unpaid Obligation</th>
                                <th>*Salary Withdrawal(Weekly,Semi-Monthly,Monthly)</th>
                                <th>*Paymaster Name</th>
                                <th>*Residence</th>
                                <th>*Certificate #</th>
                                <th>*Issued At</th>
                                <th>*Certificate Date(mm/dd/yyyy)</th>
                                <th>Payment Deduct Salary (Yes,No)</th>
                                <th>Client Deduct Salary (Yes,No)</th>
                                <th>Paymaster Conformity (Yes,No)</th>
                                <th>Location 1</th>
                                <th>Location 1 Area</th>
                                <th>Location 1 Cost</th>
                                <th>Location 1 Market Value</th>
                                <th>Location 1 Improvement</th>
                                <th>Location 2</th>
                                <th>Location 2 Area</th>
                                <th>Location 2 Cost</th>
                                <th>Location 2 Market Value</th>
                                <th>Location 2 Improvement</th>
                                <th>Children 1 Name</th>
                                <th>Children 1 Age</th>
                                <th>Children 1 Gender (Male/Female)</th>
                                <th>Children 1 Occupation</th>
                                <th>Children 2 Name</th>
                                <th>Children 2 Age</th>
                                <th>Children 2 Gender (Male/Female)</th>
                                <th>Children 2 Occupation</th>
                                <th>Children 3 Name</th>
                                <th>Children 3 Age</th>
                                <th>Children 3 Gender (Male/Female)</th>
                                <th>Children 3 Occupation</th>
                                <th>Children 4 Name</th>
                                <th>Children 4 Age</th>
                                <th>Children 4 Gender (Male/Female)</th>
                                <th>Children 4 Occupation</th>
                                <th>Children 5 Name</th>
                                <th>Children 5 Age</th>
                                <th>Children 5 Gender (Male/Female)</th>
                                <th>Children 5 Occupation</th>
                            </tr>
                            <tr>
                                <td contenteditable="true">&nbsp;</td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="row mt-2">
                    <h6 class="text-danger">Notes: Please open exported file (.csv) in Microsoft Excel Application</h6>
                </div>
                <div class="row">
                    <ul class="text-danger">
                        <li>Branches : BCD (Bacolod), LC (La Carlota)</li>
                        <li>Dates : mm/dd/YYYY format</li>
                        <li>Insurance : Insurance Name</li>
                        <li>Location : Leave blank if not applicable</li>
                        <li>Children : Leave blank if not applicable</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer bg-whitesmoke br">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" onclick="exportFile()" class="btn btn-primary">
                    <i class="fas fa-download"></i> Export
                </button>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    function exportTemplate() {
        $("#modalExport").modal('show');
    }


    function exportFile() {
        // window.location = "assets/forms/CollectionsTemplate.csv";

        // Get the table by ID
        let table = document.getElementById('tbl_export_template');

        // Convert table to CSV format
        let csvData = convertTableToCSV(table);

        // Create a hidden anchor element to download the CSV file
        let downloadLink = document.createElement('a');
        downloadLink.setAttribute('href', 'data:text/csv;charset=utf-8,' + encodeURIComponent(csvData));
        downloadLink.setAttribute('download', 'ClientsTemplate.csv');
        downloadLink.style.display = 'none';

        // Append the anchor element to the document body and click it to trigger the download
        document.body.appendChild(downloadLink);
        downloadLink.click();
        document.body.removeChild(downloadLink);
    }

    function convertTableToCSV(table) {
        let csv = [];
        let rows = table.querySelectorAll('tr');

        for (let i = 0; i < rows.length; i++) {
            let row = [],
                cols = rows[i].querySelectorAll('td, th');

            for (let j = 0; j < cols.length; j++) {
                let cellValue = cols[j].innerText.trim().replace(/"/g, '""');
                row.push('"' + cellValue + '"');
            }

            csv.push(row.join(','));
        }

        return csv.join('\n');
    }
</script>

<style>
    #tbl_export_template {
        font-family: arial, sans-serif;
        border-collapse: collapse;
        overflow-x: scroll;
        color: #0a0a0a;
        display: block;
        width: max-content;
        max-width: 100%;
        white-space: nowrap;
    }

    #tbl_export_template td,
    th {
        border: 1px solid #dddddd;
        padding: 8px;
    }

    #tbl_export_template th {
        text-align: center;
    }
</style>

<style>
    .w3-animate-left {
        position: relative;
        animation: animateleft 0.8s
    }

    @keyframes animateleft {
        from {
            left: -300px;
            opacity: 0
        }

        to {
            left: 0;
            opacity: 1
        }
    }

    .w3-animate-zoom {
        animation: animatezoom 0.8s
    }

    @keyframes animatezoom {
        from {
            transform: scale(0)
        }

        to {
            transform: scale(1)
        }
    }

    .w3-animate-top {
        position: relative;
        animation: animatetop 0.4s
    }

    @keyframes animatetop {
        from {
            top: -300px;
            opacity: 0
        }

        to {
            top: 0;
            opacity: 1
        }
    }
</style>